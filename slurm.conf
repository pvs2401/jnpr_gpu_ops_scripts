# slurm.conf file generated by configurator.html.
# Put this file on all nodes of your cluster.
# See the slurm.conf man page for more information.
#
ClusterName=Juniper-AI-Cluster
SlurmctldHost=headend-svr-1
#GresTypes=gpu,mps,bandwidth
GresTypes=gpu
#AccountingStorageTRES=gres/gpu,gres/gpu:1g.10gb,gres/gpu:3g.40gb
AccountingStorageTRES=gres/gpu,gres/gpu:A100,gres/gpu:H100,gres/gpu:MI300X
DebugFlags=CPU_Bind,gres
SlurmdDebug=debug
MpiDefault=none
ProctrackType=proctrack/cgroup
ReturnToService=1
SlurmctldPidFile=/var/run/slurmctld.pid
SlurmctldPort=6817
SlurmdPidFile=/var/run/slurmd.pid
SlurmdPort=6818
SlurmdSpoolDir=/var/spool/slurmd
SlurmUser=root
StateSaveLocation=/var/spool/slurmctld
SwitchType=switch/none
#TaskEpilog=
TaskPlugin=task/affinity,task/cgroup
#
#
# TIMERS
InactiveLimit=0
KillWait=30
#MessageTimeout=10
#ResvOverRun=0
MinJobAge=300
#OverTimeLimit=0
SlurmctldTimeout=120
SlurmdTimeout=300
UnkillableStepTimeout=120
Waittime=0
#
#
# SCHEDULING
SchedulerType=sched/backfill
SelectType=select/cons_tres
SelectTypeParameters=CR_CORE
#SelectTypeParameters=CR_CPU_Memory
#
#

# REST Stuff
AuthAltTypes=auth/jwt
AuthAltParameters=jwt_key=/var/spool/slurm/statesave/jwt_hs256.key
AccountingStorageType=accounting_storage/slurmdbd

# LOGGING AND ACCOUNTING
#AccountingStorageType=accounting_storage/none

JobCompType=jobcomp/none
#JobCompUser=
#JobContainerType=job_container/none
JobAcctGatherFrequency=30
JobAcctGatherType=jobacct_gather/linux
SlurmctldDebug=debug
SlurmctldLogFile=/var/log/slurm/slurmctld.log
SlurmdLogFile=/var/log/slurm/slurmd.log
EpilogSlurmctld=/home/vshenoy/scripts/post_job_script.sh


# COMPUTE NODES
#NodeName=A100-0[1-6] CPUs=256 Boards=1 SocketsPerBoard=2 CoresPerSocket=64 ThreadsPerCore=2 RealMemory=2051934 State=UNKNOWN Gres=gpu:8 Feature=ht,gpu
NodeName=A100-0[1-8] CPUs=256 Boards=1 SocketsPerBoard=2 CoresPerSocket=64 ThreadsPerCore=2 RealMemory=2051932 State=UNKNOWN Gres=gpu:8 Feature=ht,gpu
#NodeName=A100-07 CPUs=256 Boards=1 SocketsPerBoard=2 CoresPerSocket=64 ThreadsPerCore=2 RealMemory=2051934 State=UNKNOWN Gres=gpu:1g.10gb:7,gpu:A100:6,gpu:3g.40gb:2 Feature=ht,gpu
#NodeName=A100-07 CPUs=256 Boards=1 SocketsPerBoard=2 CoresPerSocket=64 ThreadsPerCore=2 RealMemory=2051934 State=UNKNOWN Gres=gpu:8 Feature=ht,gpu
#NodeName=A100-08 CPUs=256 Boards=1 SocketsPerBoard=2 CoresPerSocket=64 ThreadsPerCore=2 RealMemory=2051934 State=UNKNOWN Gres=gpu:8 Feature=ht,gpu

#PartitionName=A100-RAIL2-07 Nodes=A100-07 MaxTime=INFINITE State=UP
#PartitionName=A100-RAIL2-08 Nodes=A100-08 MaxTime=INFINITE State=UP
PartitionName=A100-RAIL1 Nodes=A100-0[1-4] MaxTime=INFINITE State=UP
PartitionName=A100-HALF-RAIL1 Nodes=A100-0[1-2] MaxTime=INFINITE State=UP
#PartitionName=A100-RAIL2 Nodes=A100-0[5-6] MaxTime=INFINITE State=UP
PartitionName=A100-RAIL2 Nodes=A100-0[5-8] MaxTime=INFINITE State=UP
#PartitionName=A100-INTER-RAIL Nodes=A100-01,A100-02,A100-05,A100-06 MaxTime=INFINITE State=UP
PartitionName=A100-INTER-RAIL Nodes=A100-03,A100-04,A100-05,A100-06 MaxTime=INFINITE State=UP
#PartitionName=A100-RAILS-ALL Nodes=A100-0[1-6] MaxTime=INFINITE State=UP Default=YES
PartitionName=A100-RAILS-ALL Nodes=A100-0[1-8] MaxTime=INFINITE State=UP Default=YES 
NodeName=H100-0[1-4] CPUs=224 Boards=1 SocketsPerBoard=2 CoresPerSocket=56 ThreadsPerCore=2 RealMemory=2051934 State=UNKNOWN Gres=gpu:8 Feature=ht,gpu
NodeName=MI300-0[1-2] CPUs=256 Boards=1 SocketsPerBoard=2 CoresPerSocket=64 ThreadsPerCore=2 RealMemory=1934836 State=UNKNOWN Gres=gpu:8 Feature=ht,gpu
NodeName=MI300-0[3-4] CPUs=192 Boards=1 SocketsPerBoard=2 CoresPerSocket=48 ThreadsPerCore=2 RealMemory=2063714 State=UNKNOWN Gres=gpu:8 Feature=ht,gpu
PartitionName=H100-RAILS-ALL Nodes=H100-0[1-4] MaxTime=INFINITE State=UP
PartitionName=H100-HALF-RAIL Nodes=H100-0[1-2] MaxTime=INFINITE State=UP
PartitionName=H100-HALF-RAIL2 Nodes=H100-0[3-4] MaxTime=INFINITE State=UP
PartitionName=H100-HALF-RAIL-DIFF Nodes=H100-0[2-3] MaxTime=INFINITE State=UP
PartitionName=ALL-NODES Nodes=A100-[01-08],H100-[01-04] Default=NO MaxTime=UNLIMITED State=UP
PartitionName=MI300-RAILS-ALL Nodes=MI300-0[1-4] Default=NO MaxTime=UNLIMITED State=UP
PartitionName=MI300-RAIL1 Nodes=MI300-0[1-2] Default=NO MaxTime=UNLIMITED State=UP
